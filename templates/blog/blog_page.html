{% extends "blog/blog_base.html" %}
{% load wagtailcore_tags wagtailimages_tags %}

{% block title %}{{ page.title }} — Blog{% endblock %}

{% block content %}
<div class="container my-5">
  <div class="row g-5">
    <!-- Colonne article -->
    <div class="card col-lg-8">
      <article>
        <h1 class="mb-2">{{ page.title }}</h1>
        <p class="text-muted"><em>{{ page.date }}</em></p>

        {% if page.image %}
          <figure class="mb-4">
            {% image page.image max-1200x500 class="img-fluid rounded" %}
            {% if page.image.title %}
              <figcaption class="text-muted small mt-2">{{ page.image.title }}</figcaption>
            {% endif %}
          </figure>
        {% endif %}

        {% if page.intro %}
          <div class="lead mb-3">{{ page.intro|richtext }}</div>
        {% endif %}

        <div class="prose">{{ page.body|richtext }}</div>
      </article>
    </div>

<!-- Sidebar : Articles récents -->
<aside class="col-lg-4">
  <div class="card shadow-sm">
    <div class="card-body">
      <h5 class="card-title mb-3">Articles récents</h5>

      {% if recent_articles %}
        <ul class="list-unstyled m-0">
          {% for art in recent_articles %}
            <li class="mb-3 d-flex gap-3">
              {% if art.image %}
                {% image art.image fill-80x80 class="rounded flex-shrink-0" %}
              {% endif %}
              <div>
                <a class="fw-semibold text-decoration-none" href="{{ art.url }}">
                  {{ art.title }}
                </a>
                <div class="text-muted small">{{ art.date }}</div>
              </div>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="text-muted mb-0 small">Aucun article pour le moment.</p>
      {% endif %}
    </div>
  </div>
</aside>

  </div>
</div>
{% endblock %}
